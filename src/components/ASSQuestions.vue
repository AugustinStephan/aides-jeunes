<template>
  <div>
    <div class="form__group">
      <label>
        <span class="group-title">Quand s’est terminé {{ individu.role == 'demandeur' ? 'votre' : 'son' }} dernier contrat de travail ?</span><em>(MM/AAAA)</em>
        <MonthInput v-model="individu.date_debut_chomage" />
      </label>
      
      <div>
        {{ individu.role == 'demandeur' ? 'Si vous n\'avez' : 'S\'il ou elle n\'a' }} jamais eu de contrat de travail, laissez ce champ vide.
      </div>
    </div>

    <div class="form__group">
      <YesNoQuestion v-model="individu.ass_precondition_remplie"
        v-if="capturePreconditionAss"
        >
          {{ individu.role == 'demandeur' ? 'Avez-vous' : 'A-t-il/elle' }}
          travaillé <abbr title="1825 jours (5 fois 365) couverts par un contrat de travail, en activité ou en congés.">au moins 5 ans</abbr> entre {{ yearsAgo(10) }}
          et {{ yearsAgo(0) }} ?
      </YesNoQuestion>
    </div>
  </div>
</template>

<script>
import moment from 'moment'

import MonthInput from '@/components/MonthInput'
import YesNoQuestion from '@/components/YesNoQuestion'

export default {
  name: 'ASSQuestions',
  components: {
    MonthInput,
    YesNoQuestion
  },
  props: {
    individu: Object
  },
  computed: {
    capturePreconditionAss: function() {
      var dt = moment(this.individu.date_debut_chomage)
      return this.individu.date_debut_chomage && dt.year && dt.year()
    }
  },
  methods: {
    yearsAgo: function(years) {
      var dt = moment(this.individu.date_debut_chomage)
      return this.individu.date_debut_chomage && dt.subtract(years, 'years').format('MMMM YYYY')
    }
  }
}
</script>
